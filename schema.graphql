"""
Represents a user's authentication claims/session information
"""
type Claims {
  """
  The authenticated user's ID
  """
  id: UUID!
  """
  Not Before timestamp - when the token becomes valid
  """
  nbf: Timestamp!
  """
  Expiration timestamp - when the token expires
  """
  exp: Timestamp!
}

"""
Organization entity in the system
"""
type Company {
  """
  Unique identifier
  """
  id: Int!
  """
  Company name
  """
  name: String!
  """
  Creation timestamp
  """
  createdAt: Timestamp!
  """
  Last update timestamp
  """
  updatedAt: Timestamp!
  """
  Deletion timestamp
  """
  deletedAt: Timestamp
}

"""
Authentication domain for users
"""
type Domain {
  """
  Unique identifier
  """
  id: Int!
  """
  Domain name
  """
  name: String!
  """
  Company ID
  """
  companyId: Int!
  """
  Default timezone for users
  """
  defaultTimezone: String!
  """
  Creation timestamp
  """
  createdAt: Timestamp!
  """
  Last update timestamp
  """
  updatedAt: Timestamp!
  """
  Deletion timestamp
  """
  deletedAt: Timestamp
}

type Mutation {
  """
  Logs in a user and returns its claims
  """
  login(
    """
    Optional domain name for LDAP authentication
    """
    domainName: String
    """
    Username for authentication
    """
    username: String!
    """
    User's password
    """
    password: String!
  ): Claims!
  """
  Logout a user
  """
  logout: String!
  """
  Allows users to create a post without authentication
  """
  postCreateBlind(
    """
    Input containing details for the blind post creation
    """
    postAdd: PostAddBlind!
  ): UUID!
}

"""
ISO 8601 calendar date without timezone.
Format: %Y-%m-%d

# Examples

* `1994-11-13`
* `2000-02-24`
"""
scalar NaiveDate

"""
Input type for creating a post without authentication
"""
input PostAddBlind {
  """
  Information about the user creating the post
  """
  userBy: UserBy!
  """
  Project code (not ID) to associate the post with
  """
  projectCode: String!
  """
  List of product paths to associate with the post
  """
  productPaths: [String!]!
  """
  Optional post description in markdown format
  """
  description: String
  """
  List of tags associated with the post
  """
  tags: [String!]!
  """
  List of file uploads to attach to the post
  """
  uploads: [Upload!]!
}

type Query {
  """
  Returns the claims of the currently authenticated user. If no user is authenticated, returns `None`.
  """
  whoami: Claims
  """
  Retrieve a summary for the authenticated user, indicating if they have any unconfirmed or unfilled reports.
  """
  userSummary(
    """
    The identifier for the user whose summary is to be retrieved
    """
    userBy: UserBy!
  ): [UserSummaryRecord!]!
  """
  Get all companies.
  """
  companies: [Company!]!
  """
  Get all domains.
  """
  domains: [Domain!]!
}

"""
Special day kinds for user schedule management
"""
type SpecialDayKind {
  """
  Unique numeric identifier
  """
  id: Int!
  """
  Short code (e.g., "vacation", "sick")
  """
  code: String!
  """
  Human-readable name
  """
  title: String!
  """
  Detailed description
  """
  description: String!
}

type Subscription
"""
Represents RFC 3339 and ISO 8601 date and time string such as 1996-12-19T16:39:57-08:00
"""
scalar Timestamp

"""
A UUID is a unique 128-bit number, stored as 16 octets. UUIDs are parsed as
Strings within GraphQL. UUIDs are used to assign unique identifiers to
entities without requiring a central allocating authority.

# References

* [Wikipedia: Universally Unique Identifier](http://en.wikipedia.org/wiki/Universally_unique_identifier)
* [RFC4122: A Universally Unique Identifier (UUID) URN Namespace](http://tools.ietf.org/html/rfc4122)
"""
scalar UUID

scalar Upload

"""
Oneof for different ways to identify a user.
"""
input UserBy @oneOf {
  """
  Used for identifying users that don't belong to any authentication domain
  """
  withoutDomain: UserWithoutDomain
  """
  Used for identifying users that belong to a specific authentication domain
  """
  withDomain: UserWithDomain
}

"""
Record representing a user's activity summary for a specific date
"""
type UserSummaryRecord {
  """
  The date this summary applies to
  """
  date: NaiveDate!
  """
  Hours reported for this date, if any
  """
  hours: Int
  """
  ID of a special day kind if this date is marked as a special day
  """
  specialDayKindId: Int
  """
  Whether this day's reports have been acknowledged/confirmed
  """
  ack: Boolean!
  """
  Resolves the special day kind information if this date has a special day
  """
  specialDayKind: SpecialDayKind
}

"""
Used for users who belong to an external authentication domain (like LDAP or SSO).
"""
input UserWithDomain {
  """
  The name of the authentication domain the user belongs to
  """
  domainName: String!
  """
  The globally unique identifier for the user within their domain
  """
  guid: UUID!
}

"""
Used for local users who don't belong to any specific authentication domain.
"""
input UserWithoutDomain {
  """
  The unique login identifier for the user
  """
  login: String!
}

"""
Indicates that an Input Object is a OneOf Input Object (and thus requires exactly one of its field be provided)
"""
directive @oneOf on INPUT_OBJECT

